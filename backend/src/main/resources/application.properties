# Application Name
spring.application.name=DESN Backend

# Port the backend should run on
server.port=8080

# HTTP Compression for improved performance (60-80% size reduction)
server.compression.enabled=true
server.compression.mime-types=application/json,application/xml,text/html,text/xml,text/plain,text/css,application/javascript
server.compression.min-response-size=1024

# Upstream API base url (e.g. https://api.example.com) - required
upstream.base.url=${UPSTREAM_BASE_URL:http://localhost:4000}

# Server-side API key to set on mutating requests
server.api.key=${SERVER_API_KEY:}

# CORS Configuration
app.cors.allowed-origins=${CORS_ALLOWED_ORIGINS:http://localhost:5173,http://localhost:5174}
app.cors.max-age=3600

# Tomcat connection/thread optimization
server.tomcat.threads.max=200
server.tomcat.threads.min-spare=10
server.tomcat.connection-timeout=20s
server.tomcat.keep-alive-timeout=60s
server.tomcat.max-connections=8192

# Database Configuration (H2 for development, override for production)
spring.datasource.url=${DATABASE_URL:jdbc:h2:file:./data/desn;AUTO_SERVER=TRUE}
spring.datasource.username=${DATABASE_USERNAME:sa}
spring.datasource.password=${DATABASE_PASSWORD:}
spring.datasource.driver-class-name=${DATABASE_DRIVER:org.h2.Driver}

# HikariCP Connection Pool Optimization (2-3x concurrent capacity)
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.leak-detection-threshold=60000

# JPA/Hibernate Configuration
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.dialect=${HIBERNATE_DIALECT:org.hibernate.dialect.H2Dialect}

# H2 Console (disable in production)
spring.h2.console.enabled=${H2_CONSOLE_ENABLED:true}
spring.h2.console.path=/h2-console

# Email Configuration
spring.mail.host=${MAIL_HOST:smtp.gmail.com}
spring.mail.port=${MAIL_PORT:587}
spring.mail.username=${MAIL_USERNAME:}
spring.mail.password=${MAIL_PASSWORD:}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true

# Email Notification Settings
app.email.notifications.enabled=${EMAIL_NOTIFICATIONS_ENABLED:false}
app.email.admin=${ADMIN_EMAIL:admin@desn.org.np}
app.email.from=${FROM_EMAIL:noreply@desn.org.np}

# Storage Mode (file or database)
app.storage.mode=${STORAGE_MODE:database}

# JWT Configuration
app.jwt.secret=${JWT_SECRET:dGhpc2lzYXZlcnlsb25nc2VjcmV0a2V5Zm9yand0dG9rZW5nZW5lcmF0aW9uYW5kdmFsaWRhdGlvbnRoYXRzaG91bGRiZWNoYW5nZWRpbnByb2R1Y3Rpb24=}
app.jwt.expiration=${JWT_EXPIRATION:86400000}

# Khalti Payment Gateway Configuration
khalti.public.key=${KHALTI_PUBLIC_KEY:}
khalti.secret.key=${KHALTI_SECRET_KEY:}
khalti.api.url=${KHALTI_API_URL:https://a.khalti.com/api/v2}
app.base.url=${APP_BASE_URL:http://localhost:5175}

# Actuator endpoints
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=when-authorized
management.metrics.export.prometheus.enabled=true

# Logging
logging.level.root=INFO
logging.level.com.example.proxy=INFO
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n
